{% extends 'usernavigation.html' %}
{% load static %}
{% block body %}

<section class="page-wrap">
  <div class="container">

    <!-- PAGE HEADER -->
    <div class="page-header">
      <h1>All Notes</h1>
      <p>Browse and download notes shared by everyone</p>
    </div>

    <!-- TABLE CARD -->
    <div class="glass-card">
	  <form method="get" class="table-filters">
			<!-- Branch (from DB) -->
			<select name="branch">
				<option value="">All Branches</option>
				{% for b in branches %}
				<option value="{{ b }}" {% if b == selected_branch %}selected{% endif %}>
					{{ b }}
				</option>
				{% endfor %}
			</select>

			<!-- Subject (free text search) -->
			<input
				type="text"
				name="subject"
				placeholder="Search subject..."
				value="{{ selected_subject|default:'' }}"
			>

			<!-- File type (from DB) -->
			<select name="filetype">
				<option value="">All Types</option>
				{% for f in filetypes %}
				<option value="{{ f }}" {% if f == selected_filetype %}selected{% endif %}>
					{{ f }}
				</option>
				{% endfor %}
			</select>

			<button type="submit" class="btn-primary">
				Apply
			</button>

		</form>	
      <table id="example" class="table notes-table">
        <thead>
          <tr>
            <th>#</th>
            <th>Uploaded By</th>
            <th>Date</th>
            <th>Branch</th>
            <th>Subject</th>
            <th>File</th>
            <th>Type</th>
            <th>Description</th>
          </tr>
        </thead>

        <tbody>
          {% for i in notes %}
          <tr>
            <td>{{ forloop.counter }}</td>

            <td>
				<span class="user-pill colorful">
					{{ i.user.first_name|slice:":1" }}
				</span>
				{{ i.user.first_name }} {{ i.user.last_name }}
			</td>

            <td>{{ i.uploadingdate }}</td>
            <td>{{ i.branch }}</td>
            <td><span class="subject-chip">{{ i.subject }}</span></td>

            <td>
              <a href="{{ i.notesfile.url }}" download class="btn-download">
                â¬‡ Download
              </a>
            </td>

            <td><span class="file-badge {{ i.filetype|lower }}">{{ i.filetype }}</span></td>
            <td class="truncate">
              {{ i.description }}
            </td>
          </tr>
          {% endfor %}
        </tbody>

      </table>

    </div>

  </div>
</section>

{% endblock %}
